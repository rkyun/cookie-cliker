!function(e){function t(o){if(n[o])return n[o].exports;var i=n[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:o})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=3)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.APP_VERSION="1.0",t.FPS=30,t.SAVE_INTERVAL=2,t.DATABASE_NAME="cookie-db",t.DATABASE_VERSION=1},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=n(0),c=function(){function e(){o(this,e)}return i(e,[{key:"open",value:function(){return new Promise(function(e,t){var n,o;window.indexedDB&&(n=window.indexedDB.open(r.DATABASE_NAME,r.DATABASE_VERSION),n.onerror=function(e){t(o)},n.onupgradeneeded=function(e){o=e.target.result;o.createObjectStore("producers",{keyPath:"id"}),o.createObjectStore("stats",{keyPath:"id"})},n.onsuccess=function(t){o=t.target.result,e(o)})})}},{key:"put",value:function(e,t){var n=this;return new Promise(function(o,i){n.open().then(function(n){var r=n.transaction([e],"readwrite");r.oncomplete=function(e){o()},r.onerror=function(e){i()},r.objectStore(e).put(t)})})}},{key:"getAll",value:function(e){var t=this;return new Promise(function(n,o){t.open().then(function(t){var o=t.transaction([e],"readwrite"),i=o.objectStore(e),r=i.getAll();o.oncomplete=function(e){n(r.result)},o.onerror=function(e){n()}})})}},{key:"getOneByKey",value:function(e,t){var n=this;return new Promise(function(o,i){n.open().then(function(n){var i=n.transaction([t],"readonly"),r=i.objectStore(t),c=r.get(e);i.oncomplete=function(e){o(c.result)},i.onerror=function(e){o()}})})}}]),e}();t.default=c},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=n(0),c=function(){function e(){o(this,e),this.cookieButton=document.getElementById("cookie"),this.upgradesList=document.getElementById("upgrades-list"),this.cookiesQuantity=document.getElementById("cookies-quantity"),document.getElementById("version").innerText="version: "+r.APP_VERSION,document.getElementById("auto-save").innerText="auto save: "+r.SAVE_INTERVAL+" sec"}return i(e,[{key:"renderProducers",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]&&arguments[1],"");e.forEach(function(e){var n=e.id,o=e.imgUrl,i=e.name,r=e.price,c=e.priceIncrease,a=e.level,s=e.upgradeAvailable,u=e.cookiesPerSecond,d=Math.ceil(r*Math.pow(c,a)),l=Math.round(a*u*100)/100;t+='<li class="upgrades__item item '+(!s&&"item--disabled")+'"> \n                <button class="item__button upgrade-button" data-producer-id="'+n+'"><img src="'+o+'"><p>'+i+'</p><div class="item__price"> \n                <img src="images/cookie.svg"><span>'+d+'</span></div><span class="">'+l+" cps (+"+u+')</span></button>\n                <span class="item__level">'+a+"</span>\n              </li>"}),this.upgradesList.innerHTML=t}},{key:"renderCookiesQuantity",value:function(e,t){e=Math.floor(e),t=Math.round(100*t)/100,this.cookiesQuantity.innerText=e+" (+ "+t+" cps)",document.title=e+" cookies"}},{key:"bindUpgradeProducer",value:function(e){this.upgradesList.addEventListener("click",function(t){if(t.target&&t.target.classList.contains("upgrade-button")){var n=t.target.dataset.producerId;e(n)}})}},{key:"bindAddCookie",value:function(e){var t=0;this.cookieButton.addEventListener("click",function(n){t+=12,n.target.style.transform="rotate("+t+"deg)",e()})}}]),e}();t.default=c},function(e,t,n){n(4),e.exports=n(7)},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),r=o(i),c=n(2),a=o(c),s=n(5),u=o(s),d=new r.default,l=new a.default;t.default=new u.default(d,l)},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),c=n(1),a=(o(c),n(6)),s=o(a),u=n(2),d=(o(u),n(0)),l=function(){function e(t,n){var o=this;i(this,e),this.db=t,this.view=n,this.cookies=0,this.producers=s.default,this.loadData().then(function(){o.init()}).catch(function(){o.init()})}return r(e,[{key:"init",value:function(){this.setCookiesPerSecond(),this.view.renderCookiesQuantity(this.cookies,this.cookiesPerSecond),this.view.bindUpgradeProducer(this.upgradeProducer.bind(this)),this.view.bindAddCookie(this.addCookie.bind(this)),this.view.renderProducers(this.producers),this.loop()}},{key:"loadData",value:function(){var e=this;return new Promise(function(t,n){e.db.getAll("producers").then(function(t){return e.producers.forEach(function(e){var n=t.find(function(t){return t.id===e.id});void 0!==n&&Object.assign(e,n)}),e.db.getOneByKey("cookies","stats")}).then(function(n){n&&(e.cookies=n.quantity),t()}).catch(function(){n()})})}},{key:"upgradeProducer",value:function(e){var t=this.producers.find(function(t){return e==t.id});void 0===t.level&&(t.level=0);var n=this.checkUpgradePrice(t);n>this.cookies||(t.level+=1,this.spendCookies(n),this.setCookiesPerSecond(),this.db.put("producers",{id:t.id,level:t.level}),this.db.put("stats",{id:"cookies",quantity:this.cookies}),this.view.renderProducers(this.producers))}},{key:"setCookiesPerSecond",value:function(){var e=0;this.producers.forEach(function(t){var n=t.cookiesPerSecond,o=t.level;o>0&&(e+=n*o)}),this.cookiesPerSecond=e}},{key:"addCookie",value:function(){this.cookies+=1,this.view.renderCookiesQuantity(this.cookies,this.cookiesPerSecond)}},{key:"checkUpgradePrice",value:function(e){var t=(e.id,e.level),n=e.price,o=e.priceIncrease;return 0==t?n:Math.ceil(n*Math.pow(o,t))}},{key:"spendCookies",value:function(e){this.cookies<e||(this.cookies-=e)}},{key:"availabilityChanged",value:function(e){var t=this,n=!1;return e.forEach(function(e){var o=t.checkUpgradePrice(e);t.cookies>=o?e.upgradeAvailable||(e.upgradeAvailable=!0,n=!0):e.upgradeAvailable&&(e.upgradeAvailable=!1,n=!0)}),n}},{key:"loadProducers",value:function(){var e=this;return new Promise(function(t,n){e.db.getAll("producers").then(function(e){t(e)})})}},{key:"loop",value:function(){var e=this,t=d.SAVE_INTERVAL*d.FPS,n=0;setInterval(function(){e.cookies+=e.cookiesPerSecond/d.FPS,e.view.renderCookiesQuantity(e.cookies,e.cookiesPerSecond),e.availabilityChanged(e.producers)&&e.view.renderProducers(e.producers),++n==t&&(e.db.put("stats",{id:"cookies",quantity:e.cookies}),n=0)},1e3/d.FPS)}}]),e}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=[{id:0,name:"Cursor",cookiesPerSecond:.1,description:"Just a cursor!",price:15,priceIncrease:1.15,imgUrl:"images/cursor.svg",level:0},{id:1,name:"Grandma",cookiesPerSecond:1,description:"A nice grandma to bake more cookies",price:100,priceIncrease:1.15,imgUrl:"images/grandma.svg",level:0},{id:2,name:"Farm",cookiesPerSecond:8,description:"Grows cookie plants from cookie seeds!",price:1100,priceIncrease:1.15,imgUrl:"images/farm.svg",level:0},{id:3,name:"Mine",cookiesPerSecond:47,description:"Mines out cookie dough and chocolate chips!",price:12e3,priceIncrease:1.15,imgUrl:"images/mine.svg",level:0},{id:4,name:"Factory",cookiesPerSecond:260,description:"Produce large quantities of cookies!",price:13e4,priceIncrease:1.15,imgUrl:"images/factory.svg",level:0}]},function(e,t){}]);